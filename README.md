# Парсер данных из кабинета разработчика Битрикс

Парсер забирает данные о партнерском вознаграждении (Ежедневные и Премиальные) за текущий месяц из кабинета разработчика Битрикс [https://vendors.bitrix24.ru/](https://vendors.bitrix24.ru/) и кладет их в Yandex Database для последующей работы с этими данными из Yandex DataLens. Также есть возможность забрать исторические данные за другие периоды.

## Инструкция по запуску
1. Заходим в ЛК Yandex Cloud [https://console.yandex.cloud/](https://console.yandex.cloud/) 
2. Создаем БД YDB в Serverless режиме и записываем путь к БД, что-то вроде `/ru-central1/b1g...../etnapacfa.....`
3. Создаем новую Cloud Functions, называем ее как угодно, выбираем язык Python
4. Открываем редактор функции и переносим в нее все файлы из репозитория
5. Создаем сервисный аккаунт с правами на `ydb.editor` (работу с БД) и `functions.functionInvoker` (запуск функций)
6. Указываем в параметрах:
- Время работы функции в 10 минут (обычно данные парсятся секунд за 30)
- Выделяем 512 оперативки (обычно достаточно 256)
- Указываем сервисный аккаунт 
- Переменные окружения `VENDORS_LOGIN` (логин вашего партнерского кабинета), `VENDORS_PASSWORD` (пароль вашего партнерского кабинета), `YDB_DATABASE` (путь до БД из шага 2)  
Должно получиться как-то так:  
![Screenshot](https://i.ibb.co/XfDdVh1F/2025-04-25-15-42-26.png)
7. Создаем триггер, который будет запускать функцию один раз в день

## Тестирование и загрузка исторических данных
1. Переходим в функции на вкладку сетирования запросов
2. Жмем кнопку "Тестировать запрос"
3. Если все прошло хорошо, ниже в логах покажет сколько данных выгружено или ошибку, если она у вас возникла
4. Для загрузки исторических данных при тестировании запроса в поле "Входные данные" указываем дату, за какой месяц хотим загрузить данные, например `01.02.2023` загрузит данные за февраль 2023 года

## Настройка Yandex DataLens
